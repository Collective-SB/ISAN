//Copy of [REDACTED] for inspiration

s="97531" o=0 j=-1 b=10 n=0 f=".-" d="-" r=4 i=:input
goto @
p=i c=p-i-- n+=(2*(c>1+c>3+c>5+c>7)+(s>(s-c)))*b^j++ goto 2+(c<0)
o=n-(lc==d)*(n+ln) lc=c ln=n n/=b^j j=-1 c=0 goto 2+(r-2)*(1-f>(f-lc))
@
:A=o o=0 n=0 r=5 j=-1 goto 2
:B=o o=0 n=0 r=6 j=-1 goto 2
:C=o o=0 n=0 r=7 j=-1 goto 2
:D=o o=0 n=0 r=8 j=-1 goto 2
